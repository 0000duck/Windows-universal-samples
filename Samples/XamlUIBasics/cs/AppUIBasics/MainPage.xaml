<!--
//*********************************************************
//
// Copyright (c) Microsoft. All rights reserved.
// THIS CODE IS PROVIDED *AS IS* WITHOUT WARRANTY OF
// ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY
// IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR
// PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.
//
//*********************************************************
-->
<Page x:Name="pageRoot" x:Class="AppUIBasics.MainPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:local="using:AppUIBasics"
        xmlns:data="using:AppUIBasics.Data" xmlns:common="using:AppUIBasics.Common"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:controls="using:Windows.UI.Xaml.Controls"
        xmlns:media="using:Windows.UI.Xaml.Media"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
        xmlns:interactivity="using:Microsoft.Xaml.Interactivity" xmlns:behavior="using:AppUIBasics.Behaviors"
        NavigationCacheMode="Enabled" SizeChanged="pageRoot_SizeChanged">
    <Page.BottomAppBar>
        <CommandBar x:Name="bottomAppBar" Visibility="Collapsed" IsOpen="False" ClosedDisplayMode="Compact"
                IsSticky="False">
            <AppBarButton x:Name="searchButton" Label="Search" Icon="Find" Click="SearchButton_Click" />
        </CommandBar>
    </Page.BottomAppBar>
    <Page.Resources>
        <DataTemplate x:Key="ControlItemTemplate" x:DataType="data:ControlInfoDataItem">
            <Grid x:Name="controlRoot" Height="145" Width="345" Padding="15" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Image x:Name="gridImage" Source="{x:Bind ImagePath}" Stretch="Uniform" Width="36" VerticalAlignment="Top"
                        AutomationProperties.Name="{x:Bind Title}" />
                <RelativePanel Grid.Column="1" Margin="32,0,0,0">
                    <TextBlock Text="{x:Bind Title}" Style="{StaticResource SubtitleTextBlockStyle}" x:Name="titleText"
                            TextLineBounds="TrimToCapHeight" TextWrapping="NoWrap" FontWeight="SemiBold"
                            Foreground="{ThemeResource HyperlinkButtonForeground}" />
                    <TextBlock Text="{x:Bind Subtitle}" Style="{StaticResource BodyTextBlockStyle}" Margin="0,4,0,0"
                            TextTrimming="CharacterEllipsis" RelativePanel.Below="titleText" />
                </RelativePanel>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="ControlItemTemplateSmall" x:DataType="data:ControlInfoDataItem">
            <Grid x:Name="controlRoot" Height="145" Width="332" Padding="15" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Image  x:Name="gridImage" Source="{x:Bind ImagePath}" Stretch="Uniform" Width="36" VerticalAlignment="Top"
                        AutomationProperties.Name="{x:Bind Title}" />
                <RelativePanel Grid.Column="1" Margin="32,0,0,0">
                    <TextBlock x:Name="titleText" Text="{x:Bind Title}" Style="{StaticResource SubtitleTextBlockStyle}"
                            TextLineBounds="TrimToCapHeight" TextWrapping="NoWrap" FontWeight="SemiBold"
                            Foreground="{ThemeResource HyperlinkButtonForeground}" />
                    <TextBlock Text="{x:Bind Subtitle}" Style="{StaticResource BodyTextBlockStyle}" Margin="0,4,0,0"
                            TextTrimming="CharacterEllipsis" RelativePanel.Below="titleText" />
                </RelativePanel>
            </Grid>
        </DataTemplate>
    </Page.Resources>
    <!-- This grid acts as a root panel for the page. -->
    <Grid Background="{StaticResource HomePageBackgroundBrush}">
        <GridView x:Name="itemGridView" AutomationProperties.AutomationId="ItemGridView" Padding="24,0,0,0" Loaded="itemGridView_Loaded" ContainerContentChanging="itemGridView_ContainerContentChanging"
                AutomationProperties.Name="Items In Group" ItemsSource="{x:Bind Items, Mode=OneWay}" KeyDown="itemGridView_KeyDown"
                ItemTemplate="{StaticResource ControlItemTemplate}"
                SelectionMode="None" ScrollViewer.VerticalScrollBarVisibility="Auto"
                ItemContainerStyle="{StaticResource GridViewItemStyle}" ScrollViewer.VerticalScrollMode="Auto"
                IsSwipeEnabled="False" IsItemClickEnabled="True" ItemClick="ItemView_ItemClick">
            <interactivity:Interaction.Behaviors>
                <behavior:ImageScrollBehavior TargetControl="{Binding ElementName=pageHeader}" />
            </interactivity:Interaction.Behaviors>
            <GridView.Header>
                <controls:ParallaxView  x:Name="headerImageView" VerticalShift="350" Source="{x:Bind itemGridView}" Height="250"
                        Margin="-24,0,0,24">
                    <Grid>
                        <Image x:Name="headerImage" Source="Assets/MainPage_Banner.jpg" HorizontalAlignment="Center" Stretch="UniformToFill" />
                        <Rectangle>
                            <Rectangle.Fill>
                                <media:AcrylicBrush TintColor="Black" Opacity=".3" BackgroundSource="Backdrop" />
                            </Rectangle.Fill>
                        </Rectangle>
                    </Grid>
                </controls:ParallaxView>
            </GridView.Header>
            <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <ItemsWrapGrid Orientation="Horizontal" >
                        <ItemsWrapGrid.ChildrenTransitions>
                            <TransitionCollection>
                                <EntranceThemeTransition
                            FromHorizontalOffset="400" />
                            </TransitionCollection>
                        </ItemsWrapGrid.ChildrenTransitions>
                    </ItemsWrapGrid>
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
        </GridView>
        <local:PageHeader x:Name="pageHeader" Background="{StaticResource HomePageBackgroundBrush}" FontSize="42"
                Title="{StaticResource AppName}" Foreground="White" VerticalAlignment="Top" BackgroundBrush="Transparent"/>
        <VisualStateManager.VisualStateGroups>
            <!-- Visual states reflect the application's window size -->
            <VisualStateGroup>
                <VisualState x:Name="WideLayout">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters></VisualState.Setters>
                </VisualState>
                <VisualState x:Name="NarrowLayout">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="itemGridView.Padding" Value="14,0,0,0" />
                        <Setter Target="itemGridView.ItemTemplate" Value="{StaticResource ControlItemTemplateSmall}" />
                        <Setter Target="itemGridView.ItemContainerStyle" Value="{StaticResource GridViewItemStyleSmall}" />
                        <Setter Target="pageHeader.Visibility" Value="Collapsed" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
